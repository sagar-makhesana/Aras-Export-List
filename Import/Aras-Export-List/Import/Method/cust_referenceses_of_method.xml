<AML>
 <Item type="Method" id="E168F202D6FF414C863F6DA246179FBA" action="add">
  <execution_allowed_to keyed_name="World" type="Identity">A73B655731924CD0B027E4F4D5FCC0A9</execution_allowed_to>
  <method_code><![CDATA[var inn = top.aras.newIOMInnovator();
var ItemId = this.getID();
var buildHTMLStart = "";

// get itemtype's relationships
var aml = "";
aml += "<AML>";
aml += "  <Item type='ItemType' action='get' id='" + ItemId + "' select='keyed_name'>";
aml += "    <Relationships>";
aml += "      <Item type='RelationshipType' select='related_id'>";
aml += "        <related_id>";
aml += "          <Item type='ItemType' select='name,config_id' />";
aml += "        </related_id>";
aml += "      </Item>";
aml += "      <Item type='View' select='related_id'>";
aml += "        <related_id>";
aml += "          <Item type='Form' select='name,config_id' />";
aml += "        </related_id>";
aml += "      </Item>";
aml += "      <Item type='Allowed Workflow' select='related_id'>";
aml += "        <related_id>";
aml += "          <Item type='Workflow Map' select='name,config_id' />";
aml += "        </related_id>";
aml += "      </Item>";

// query is incomplete - it needs the other related items added

aml += "    </Relationships>";
aml += "  </Item>";
aml += "</AML>";

var itemtype = inn.applyAML(aml);

if (itemtype.isError())
    return alert("Could not retrieve ItemType with id = '" + ItemId + "'.");

// get package elements for the itemtype's related items
var rels = itemtype.getItemsByXPath("//related_id/Item");
aml = "<AML>";

for (var i = 0; i < rels.getItemCount(); i++) {
    aml += "<Item type='PackageElement' action='get' select='source_id(source_id),element_id'><element_id>";
    aml += rels.getItemByIndex(i).getID();
    aml += "</element_id></Item>";
}

aml += "</AML>";
var packageElements = inn.applyAML(aml);


if (rels.getItemCount() > 0) 

{
    buildHTMLStart += "<html>";
    buildHTMLStart += "<head>";
    buildHTMLStart += "</head>";
    buildHTMLStart += "<body>";
    buildHTMLStart += "<h1>Referenced Items for '" + itemtype.getProperty("keyed_name", "") + "' ItemType</h1>";
    buildHTMLStart += "<table border= '1px solid black' width = '100%'>";
    buildHTMLStart += "<tr>";
    buildHTMLStart += "<th align='center'>Object Type</th>";
    buildHTMLStart += "<th align='center'>Object Name</th> ";
    buildHTMLStart += "<th align='center'>Package Name</th> ";

    buildHTMLStart += "</tr>";

    for (var i = 0; i < rels.getItemCount(); i++) 
    
    {
        
        var r = rels.getItemByIndex(i);
        var p = packageElements.getItemsByXPath("//Item[element_id='"+r.getID()+"']/source_id/Item").getItemByIndex(0);
        
        var obj = r.getType();
        var obj1 = r.getProperty("name", r.getProperty("keyed_name", ""));
	var packageDetail = p.getPropertyAttribute("source_id","keyed_name","");

        buildHTMLStart += "<tr>";
        buildHTMLStart += "<td>" + obj + "</td>";
        buildHTMLStart += "<td>" + obj1 + "</td>";
        buildHTMLStart += "<td>"+ packageDetail +"</td>";

        buildHTMLStart += "</tr>";

    }

    buildHTMLStart += "</table>";
buildHTMLStart += "</body>";

buildHTMLStart += "</html>";
    }

return buildHTMLStart;]]></method_code>
  <method_type>JavaScript</method_type>
  <name>cust_referenceses_of_method</name>
 </Item>
</AML>